<?xml version="1.0"?>

<!--The ode physics engine (open dynamics engine) uses a pyramid model for friction-->
<!--The friction is a maximum force mu1*Fn where mu1 is the friction coefficient and Fn is the normal force-->
<!--Therefore the frictional force will decrease the wheel's angular speed linearly [v = v0 - (Ff/m)*t] -->


<robot name="block" xmlns:xacro="http://ros.org/wiki/xacro">
  <link name="heavy_block">
    <!--visual box-->
    <visual>
      <geometry>
        <box size = "1.0 1.0 1.0"/>
      </geometry>
    </visual>
    <!--collision-->
    <collision>
      <geometry>
        <box size = "1.0 1.0 1.0"/>
      </geometry>
    </collision>
    <!--inertial-->
    <inertial>
      <mass value="1.0"/>
      <inertia ixx="0.1667" ixy="0.0" ixz="0.0" iyy="0.1667" iyz="0.0" izz="0.1667"/>
    </inertial>
  </link>
  
  
  <link name="wheel">
    <!--visual box-->
    <visual>
      <origin xyz="0 0 0" rpy="0 1.57 0"/>
      <geometry>
        <cylinder radius="0.25" length="0.10"/>
      </geometry>
    </visual>
    <!--collision-->
    <collision>
      <origin xyz="0 0 0" rpy="0 1.57 0"/>
      <geometry>
        <cylinder radius="0.25" length="0.10"/>
      </geometry>
    </collision>
    <!--inertial-->
    <inertial>
      <mass value="0.1"/>
      <inertia ixx="0.1667" ixy="0.0" ixz="0.0" iyy="0.1667" iyz="0.0" izz="0.1667"/>
    </inertial>
  </link>
  
  <joint name="rev1" type="continuous">
    <parent link ="heavy_block"/>
    <child link ="wheel"/>
    <origin xyz="0.55 0 0.25" rpy="0 0 0"/>
    <axis xyz="1.0 0 0"/>
    <limit effort="1000.0" lower="0.0" upper="0.0" velocity="0.5"/>
  </joint>
  
  <gazebo reference="heavy_block">
    <material>Gazebo/Orange</material>
    <mu1>0.8</mu1>
    <mu2>0.8</mu2>
    <min_depth>0.01</min_depth>
    <kp>1e4</kp>
    <kd>1.0</kd>
  </gazebo>
  
  
  <!--Unpause the simulation, apply a 100[N*m] Torque too the wheel-->
  <!-- Set mu1,2 = 0.8 notice the speed decreases slowly-->
  <!-- Set mu1,2 = 8.0 notice the speed decreases modestly -->
  <!-- Set mu1,1 = 80.0 notice the speed decreases rapidly-->
  
  <gazebo reference="grinder_block">
    <material>Gazebo/Orange</material>
    <mu1>80.0</mu1>
    <mu2>80.0</mu2>
    <min_depth>0.01</min_depth>
    <kp>1e4</kp>
    <kd>1.0</kd>
  </gazebo>
  
  <gazebo reference="wheel">
    <material>Gazebo/White</material>
    <mu1>80.0</mu1>
    <mu2>80.0</mu2>
    <min_depth>0.01</min_depth>
    <kp>1e4</kp>
    <kd>1.0</kd>
  </gazebo>
  
</robot>
